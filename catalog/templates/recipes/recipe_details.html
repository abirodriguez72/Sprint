{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="{% static '/style.css' %}">
    <link rel="stylesheet" href=href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Source+Sans+3:ital,wght@0,200..900;1,200..900&display=swap">
    <title>{{ recipe.title }} - Recipe Details</title>
</head>
<body>
    <h1>{{ recipe.title }}</h1>
    <p><strong>By:</strong> <a href="{% url 'user_detail' recipe.user.user_id %}">{{ recipe.user.user_name }}</a></p>

    <h2>Ingredients</h2>
    <p>{{ recipe.ingredients }}</p>

    <h2>Instructions</h2>
    <p>{{ recipe.instructions }}</p>

    {% if recipe.notes %}
        <h3>Notes</h3>
        <p>{{ recipe.notes }}</p>
    {% endif %}

    {% if recipe.photo %}
        <img src="{{ recipe.photo.url }}" alt="Photo of {{ recipe.title }}">
    {% endif %}

    <h2>Reviews</h2>
    <ul>
        {% for review in reviews %}
            <li>
                <strong>{{ review.user.user_name }}</strong> rated this recipe {{ review.rating }} stars.
                {% if review.comment %}
                    <p>{{ review.comment }}</p>
                {% endif %}
                <p><em>Reviewed on {{ review.created_at|date:"M d, Y" }}</em></p>
            </li>
        {% empty %}
            <li>No reviews yet.</li>
        {% endfor %}
       
 <h1>{{ recipe.title }}</h1>
<p><strong>Ingredients:</strong> {{ recipe.ingredients }}</p>
<p><strong>Instructions:</strong> {{ recipe.instructions }}</p>

<h3> Average Rating: {{ average_rating|default:"No ratings yet" }}</h3>

{% if user.is_authenticated %}
    {% if existing_review %}
        <p>You already reviewed this recipe.</p>
    {% else %}
        <h4>Leave a Review</h4>
        <form method="POST">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">Submit Review</button>
        </form>
    {% endif %}
{% else %}
    <p><a href="{% url 'login' %}">Log in</a> to leave a review.</p>
{% endif %}

<h3>All Reviews</h3>
{% for review in reviews %}
    <p><strong>{{ review.user.username }}</strong> ({{ review.rating }}‚≠ê):<br>{{ review.comment }}</p>
{% empty %}
    <p>No reviews yet.</p>
{% endfor %}
    </ul>

    <p><a href="{% url 'recipe_list' %}">Back to Recipe List</a></p>
</body>
</html>
